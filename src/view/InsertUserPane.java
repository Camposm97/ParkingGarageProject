package view;

import static util.LightWork.initGridPaneSettings;

import app.App;
import javafx.geometry.Pos;
import javafx.scene.control.Alert;
import javafx.scene.control.Alert.AlertType;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.PasswordField;
import javafx.scene.control.TextField;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.HBox;
import userData.UserData;
import userData.UserDataManager;
import util.LightWork;

/**
 * For adding users to the User Data Structure
 * User is auto-generated by first name and last name
 * @author Camposm97
 */
public class InsertUserPane extends GridPane {
	private UserDataManager users;
	private TextField tfFirst, tfLast;
	private PasswordField tfPassword;
	private Button bt;
	
	public InsertUserPane(UserDataManager users) {
		this.users = users;
		initGridPaneSettings(this);
		initControls();
		showControls();
	}
	
	private void initControls() {
		tfFirst = new TextField();
		tfLast = new TextField();
		tfPassword = new PasswordField();
		bt = loadBtAdd();
	}
	
	private void showControls() {
		Label lblFirst = new Label("First Name:");
		Label lblLast = new Label("Last Name:");
		Label lblPassword = new Label("Password:");
		HBox hBox = LightWork.loadHBox(bt);
		hBox.setAlignment(Pos.CENTER);
		addColumn(0, lblFirst, lblLast, lblPassword);
		addColumn(1, tfFirst, tfLast, tfPassword);
		add(hBox, 0, 4, 2, 1);
	}
	
	private Button loadBtAdd() {
		Button bt = new Button("Add User");
		bt.setOnAction(e -> {
			String firstName = tfFirst.getText();
			String lastName = tfLast.getText();
			if (!firstName.isEmpty() && !lastName.isEmpty()) {
				String password = tfPassword.getText();
				users.addUser(firstName, lastName, password);
				UserData user = users.getUserList().get(users.getUserList().size() - 1);
				Alert alert = new Alert(AlertType.INFORMATION);
				alert.setHeaderText("Successfully added user!");
				alert.setContentText("Username: " + user.getUserName() + "\n" + "Password: " + password);
				alert.showAndWait();
			} else {
				Alert alert = new Alert(AlertType.ERROR);
				alert.setTitle(App.TITLE);
				alert.setHeaderText("First Name or Last Name Field is empty!");
				alert.setContentText("Please make sure the fields are not empty.");
				alert.showAndWait();
			}
		});
		return bt;
	}
}
